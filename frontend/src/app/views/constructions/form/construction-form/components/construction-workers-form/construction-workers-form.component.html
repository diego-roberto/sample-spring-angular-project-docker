<form (ngSubmit)="save()" novalidate>
    <div class="body-content" *ngIf="workers.length === 0 && workersOfConstruction.length === 0">
        <div fxFlex fxLayout="column" fxLayoutAlign="space-around center">
            <div fxFlex class="hello">
                <p>Não existem trabalhadores cadastrados na empresa, para iniciar cadastre um
                    <b>novo trabalhador.</b>
                </p>
            </div>
            <div fxFlex>
                <a class="start" md-raised-button type="button" name="button" [routerLink]="['/workers/new']">
                    <span>Cadastrar</span>
                </a>
            </div>
        </div>
    </div>
    <div *ngIf="workers.length > 0 || workersOfConstruction.length > 0" fxLayout.gt-sm="row" fxLayout.lt-md="column">
        <div fxFlex.gt-sm="45" fxFlex.lt-md="100" fxLayout.lt-md="row" fxLayout.gt-sm="column">
            <div class="workers-selection">

                <section class="left-side-selection">
                    <h2>Todos os trabalhadores</h2>
                    <md-input-container>
                        <md-icon mdPrefix>search</md-icon>
                        <input mdInput maxlength="30" #workers (input)="searchWorkers(workers.value)" placeholder="Buscar por nome, CPF ou função">
                    </md-input-container>

                    <table>
                        <tr class="bordered" *ngIf="filteredWorkers.length > 0">
                            <thead>
                                <md-checkbox (change)="setAllSelectedToAdd()" [checked]="checkedAddAll">
                                    Todos
                                </md-checkbox>
                            </thead>
                        </tr>
                        <virtual-scroll [items]="filteredWorkers" (update)="scrollWorkers = $event" [childHeight]="34" [bufferAmount]="5" *ngIf="filteredWorkers.length > 0">
                            <tbody>
                                <tr *ngFor="let c of scrollWorkers">
                                    <div fxLayout>
                                        <md-checkbox (change)="setSelectedToAdd(c)" [checked]="selectedToAdd.includes(c)">
                                        </md-checkbox>
                                        <td [mdTooltip]="c?.name">{{ c.name }}</td>
                                    </div>
                                    <td [mdTooltip]="c.cbos?.title" class="cbo">{{ c.cbos.title }}</td>
                                    <td class="cpf" fxHide.xs>{{ c.cpf | cpfMask }}</td>
                                </tr>
                            </tbody>
                        </virtual-scroll>
                    </table>

                    <p *ngIf="filteredWorkers.length === 0">Todos os trabalhadores estão relacionados à obra</p>
                </section>
            </div>
        </div>

        <div fxLayout.lt-md="row" fxLayout.gt-sm="column" fxLayout.gt-sm="column" class="button-group" fxLayout.lt-md="row">
            <button md-button [disabled]="selectedToAdd.length === 0" (click)="addSelected()">
                <md-icon fxHide.lt-md>keyboard_arrow_right</md-icon>
                <md-icon fxHide fxShow.lt-md>keyboard_arrow_down</md-icon>
            </button>
            <button md-button [disabled]="selectedToRemove.length === 0" (click)="removeSelected()">
                <md-icon fxHide.lt-md>keyboard_arrow_left</md-icon>
                <md-icon fxHide fxShow.lt-md>keyboard_arrow_up</md-icon>
            </button>
        </div>

        <div fxFlex.gt-sm="45" fxFlex.lt-md="100" fxLayout.lt-md="row" fxLayout.gt-sm="column">
            <section class="right-side-selection">
                <h2>Trabalhadores relacionados à obra</h2>

                <md-input-container>
                    <md-icon mdPrefix>search</md-icon>
                    <input mdInput maxlength="30" #workersOfConstruction (input)="searchWorkersOfConstruction(workersOfConstruction.value)" placeholder="Buscar por nome, CPF ou função">
                </md-input-container>

                <table>
                    <tr class="bordered" *ngIf="filteredWorkersOfConstruction.length > 0">
                        <thead>
                            <md-checkbox (change)="setAllSelectedToRemove()" [checked]="checkedRemoveAll">
                                Todos
                            </md-checkbox>
                        </thead>
                    </tr>
                    <virtual-scroll [items]="filteredWorkersOfConstruction" (update)="scrollWorkersOfConstruction = $event" [childHeight]="34" [bufferAmount]="5"  *ngIf="filteredWorkersOfConstruction.length > 0">
                        <tbody>
                            <tr *ngFor="let c of scrollWorkersOfConstruction">
                                <div fxLayout>
                                    <md-checkbox class="name" (change)="setSelectedToRemove(c)" [checked]="selectedToRemove.includes(c)">
                                    </md-checkbox>
                                    <td [mdTooltip]="c?.name">{{ c.name }}</td>
                                </div>
                                <td [mdTooltip]="c.cbos?.title" class="cbo">{{ c.cbos.title }}</td>
                                <td class="cpf" fxHide.xs>{{ c.cpf | cpfMask }}</td>
                            </tr>
                        </tbody>
                    </virtual-scroll>
                </table>

                <p *ngIf="filteredWorkersOfConstruction.length === 0">Nenhum trabalhador está relacionado à obra</p>
            </section>
        </div>
    </div>
    <div class="form-bottom" *ngIf="workers.length > 0 || workersOfConstruction.length > 0">
        <button md-raised-button class="button-default" [disabled]="formValidator()">SALVAR E CONTINUAR</button>
    </div>
</form>